<meta http-equiv="Content-Type" content="text/html" charset="utf-8" />

<div class="wrapper fadeInDown">
    <div id="formContent">
      <!-- Tabs Titles -->
      <a class="inactive underlineHover" type="link" href="./index.html"> Sign In </a>
      <h2 class="active" >Sign Up </h2>
      <link rel="stylesheet" href="login.css">
    
      <!-- Icon -->
      <div class="fadeIn first">


      </div>

      <!-- Login Form -->
      <form id="myForm">
        <img class="picture"src="./panel/React-parcel/src/img/le logo.png" alt="logo">
        <p>welcome to STL editor</p>
      <div id="message"></div>
        
        <input type="text" id="firstname" class="fadeIn second" name="login" placeholder="firstname">
        <input type="text" id="lastname" class="fadeIn second" name="login" placeholder="lastname">
        <input type="text" id="Mail" class="fadeIn second" name="login" placeholder="Mail">
        <input type="password" id="password" class="fadeIn third" name="login" placeholder="password">
        <input type="password" id="password2" class="fadeIn third" name="login" placeholder="confirme password">
        <input type="button" id="register" class="fadeIn fourth" value="Sign Up" > 
      </form>

      <!-- Remind Passowrd -->

    

    </div>
    <div class="fun" id="fun">

      <p>Fun fact</p>
      <p id="fun">Err :backend</p>
    </div>

</div>
<div id ='redirect'>
</div>
<script src="com.js"></script>

<script>
  
document.getElementById("register").onclick = function(){
    Register()
}

async function Register(){


    message.innerHTML = "<p>Please wait...<p/>"
var password = document.getElementById("password").value;
var mail = document.getElementById("Mail").value
var password2 = document.getElementById("password2").value
var firstname = document.getElementById("firstname").value
var lastname = document.getElementById("lastname").value
    var ok = true
if(password && mail && password2 && firstname && lastname != ""){
  ok = true
}else{
  ok = false
  message.innerHTML = "<p>Err: Incomplete field<p/>"
}
if(ok){
    await fetch(ServerBackend+'/user/adduser', {
        method: 'POST',
        headers: {
         'Accept': 'application/json',
         'Content-Type': 'application/json',
        },
        body: JSON.stringify({
        'firstname': firstname,
        'lastname': lastname,
         'mail': mail,
         'password': password,
        })
        })
        
        .then(function (response) {
           console.log(response);
           if (response.ok == true) {
             console.log(response.ok);
             result = response.ok
             message.innerHTML = "<p>Ok ! Please wait...<p/> "
             var now = new Date();
             
        var annee   = now.getFullYear();
        var mois    = ('0'+now.getMonth()+1).slice(-2);
        var jour    = ('0'+now.getDate()   ).slice(-2);
             localStorage.setItem('Login',mail)
             localStorage.setItem('password',password)
             localStorage.setItem('date',jour+mois+annee)
             //Getadmin(login)
           }
           else {
             console.log(response.ok);
             result = response.ok
            
           }
           
         })
        
        .catch(function (error) {
         console.log(error);
         message.innerHTML = "<p>Err: Backend is down<p/>"
        });
}else{
    message.innerHTML = "<p><p/>"
}



    
    }

</script>